---
lab: 4
title: 演習 3 - データ損失防止
---

# ラボ 4 - 演習 3 - データ損失防止

Contoso Ltd. は現在、Tailwind Traders をプロジェクトに統合しています。 合併はまだ進行中ですが、両社は別々のテナント内で運営されています。 Tailwind Traders の従業員は外部ユーザーと見なされ、SharePoint サイトとファイルの共有を容易にするために Contoso のテナントにゲストとして招待されます。 特定のプロジェクトでは、選択した Tailwind Traders の従業員は、セキュリティ監視を維持しながら内部リソースへのフル アクセスを確保するために、Contoso Ltd. が管理する Windows 11 クライアントを受け取ります。 M365 デスクトップ アプリケーションへのアクセスはアンマネージド デバイスではブロックされ、これらのユーザーは Web アプリケーション経由でのみ環境にアクセスできます。 マネージド デバイスは、エンドポイント マネージャーのさまざまなポリシーによって保護されます。 Contoso Ltd. は、含まれる情報の種類に基づいて機密性の高いドキュメントを暗号化するための Microsoft Purview 情報保護を実装しました。 

サイバーセキュリティ アーキテクトとして、最近 Defender for Cloud Apps アクティビティ ログでさまざまなアクティビティを調べ、機密としてマークされた一部のドキュメントが外部 USB ドライブにコピーされていることを発見しました。 また、ユーザーがアクセスできる会社のデータを、管理されていない個人用デバイスに自由に保存できることも判明しました。 これにより、対処が必要な大きな問題が発生します。 ソリューションとして、管理されていない個人用デバイス上の会社のデータ保存を制限するセキュリティ ポリシーを設計します。 これにより、機密データが侵害されるリスクを最小限に抑えることができます。

## パート 1: ソリューションを設計する (必須)

このタスクでは、Contoso Ltd. が直面しているリスクに対処するための概念を設計します。

### 設計アプローチ

最初の手順では、説明されている問題に基づいて要件を分析し、目的を理解し、要件を定義します。

提供されているユース ケースに基づいて、次の要件を概説できます。

- USB ドライブへのデータ転送の防止
- アンマネージド デバイスからの機密データへのアクセスの制限
- アンマネージド デバイスからの機密データのダウンロードのブロック

2 番目の手順では、Contoso Ltd. の既存の環境を調べます。 Microsoft Purview と Microsoft Defender は、Microsoft Purview 情報保護、データ損失防止、条件付きアクセス、および保持ポリシーを含む、データ フローを管理するためのさまざまなソリューションを提供します。 既に配置されているコントロールを調査します。 さまざまなポータルにアクセスして、現在の構成とポリシーを確認し、調整が必要かどうか、または新しい設定/ポリシーの実装が必要かどうかを判断します。

3 番目のフェーズでは、ソリューションの概念を作成します。 調査の結果、現在のポリシーのいずれも定義された要件を満たしていないのは明らかです。 そのため、新しい一連のポリシーが必須です。

### 提案されるソリューション

管理されていない個人用デバイス上の会社のデータの保存を制限するセキュリティ ポリシーを設計します。 これにより、機密データが侵害されるリスクを最小限に抑えることができます。 このポリシーでは、機密と見なされるデータの種類と、それらを保存できる許容デバイスを明記する必要があります。 さらに、このポリシーでは、外部デバイスへのデータの安全な転送に関するガイドラインを提供する必要があります。 従業員は、ポリシーの理解と、ポリシーの遵守に対するコミットメントを確認する契約に署名する必要があります。 このポリシーは、すべての従業員に伝達し、コンプライアンス違反に対する定期的な監査と処分措置を通じて実施する必要があります。 また、従業員が個人用デバイスに会社のデータを保存することに伴うリスクと、ポリシーに従うことの重要性を認識するように、定期的なトレーニング セッションを実施する必要があります。 最後に、ポリシーを定期的に見直して更新し、有効で関連性が維持されるようにする必要があります。 

|要件|解決策|行動計画|
|----|----|----|
|USB ドライブへのデータの移動をブロックする|エンドポイントのデータ損失防止|機密ラベルの付いたすべてのデータが USB ドライブにコピーされるのをブロックする|
|アンマネージド デバイスからの機密データへのアクセスを制限する|Defender for Cloud アプリ|アンマネージド デバイスのデータのコピー/切り取り/貼り付けをブロックする|
|アンマネージド デバイスからの機密データのダウンロードをブロックする|Defender for Cloud アプリ|アンマネージド デバイスからのデータのダウンロードをブロックする|

## パート 2: ソリューションを実施する (オプション)

### タスク 1: データ損失防止ポリシーをデプロイする

ソリューション設計の最初の手順では、エンドポイントのデータ損失防止ルールを作成します。 USB ドライブへのデータのコピーをブロックする DLP ルールをデプロイします。 

1. 管理者アカウント **MOD 管理者**を使用して、Allan Deyoung として Microsoft Purview コンプライアンス ポータル **https://compliance.microsoft.com** にサインインします。
1. クラシック Microsoft Purview コンプライアンス ポータルへの切り替えを促すメッセージが表示されたら、**[切り替え]** を選択します。
1. Microsoft Purview ポータルの左側のナビゲーション ウィンドウで **[データ損失防止]** を展開し、**[ポリシー]** を選択します。
1. **[ポリシー]** ページで、 **[+ ポリシーの作成]** を選択します。
1. **[テンプレートの利用またはカスタム ポリシーの作成]** ページで、**[カスタム]**、**[カスタム ポリシー]** の順に選択し、**[次へ]** を選択します。
1. **[DLP ポリシーの名前を設定]** ページで、[名前] と [説明] を入力し、**[次へ]** を選択します。
1. [**管理単位の割り当て**] ページで、[**次へ**] を選択します。
1. **[ポリシーを適用する場所の選択]** ページで **[デバイス]** のみを選択し、**[次へ]** を選択します。
1. **[ポリシー設定の定義]** ページで **[次へ]** を選択します。
1. **[詳細な DLP ルールのカスタマイズ]** ページで、**[+ ルールの作成]** を選択します。
1. ルールの名前と説明を入力します。 
1. **[条件]** で、**[+ 条件の追加]** を選択し、**[コンテンツに含まれている]** を選択します。
1. 次の条件を指定します。

    - **[コンテンツに含まれている]** 
      - **[追加]** を選択したあと、**[秘密度ラベル]** を選択し、ラベル **[信頼されたユーザー]**、**[Project - Falcon]**、**[機密]**、**[極秘]**、**[機密 - 財務]** を選択します。 **追加**をクリックします。
13. **[アクション]** で、**[+ アクションの追加]** を選択し、**[デバイスでのアクティビティの監査または制限]** を選択します。
14. 次のアクションを指定します。
   -    **[すべてのアプリのファイル アクティビティ]** で **[特定のアクティビティに制限を適用する]** を選択します。
      - **[リムーバブル USB デバイスにコピー]** が選択されていることを確認し、この設定のドロップダウン メニューから **[ブロック]** オプションを選択します。
      - 他の設定はそのままにします。
15. **[保存]** を選択します。
16. [**次へ**] を選択します。
17. **[ポリシー モード]** ページで、**[ポリシーをすぐに有効にする]** を選択します。 [**次へ**] を選択します。
18.  **[確認と完了]** ページで、**[送信]** を選択します。

USB ドライブへのデータのコピーをブロックするデータ損失防止ポリシーが正常に実装されました。

### タスク 2: アプリケーションをアプリの条件付きアクセス制御にオンボードする

Defender for Cloud Apps でセッション ポリシーを作成することがソリューションの一部になります。 セッション ポリシーは、セッションをリアルタイムで監視して、クラウド アプリケーションに関する包括的な分析情報を提供します。 これらのポリシーにより、ユーザー セッションごとに、指定されたポリシーに従ってアクションを調整できるようになります。 セッション ポリシーを作成するには、アプリの条件付きアクセス制御をアプリケーションにデプロイする必要があります。 アプリの条件付きアクセス制御により、アプリのリアルタイム監視および制御の機能が追加されます。 アプリの条件付きアクセス制御にアプリをオンボードせずにセッション ポリシーを作成しても機能しません。 最初の手順では、保護するアプリケーションをアプリの条件付きアクセス制御にオンボードします。 

アプリの条件付きアクセス制御にアプリケーションをオンボードするには、次の 2 とおりの方法があります。

- Microsoft Defender ポータルでアプリケーションを手動で追加する ([設定]、[クラウド アプリ]、[接続されたアプリ]、[アプリの条件付きアクセス制御] の順に選択します)
- Defender for Cloud Apps でアプリを保護するように条件付きアクセス ポリシーを構成する

条件付きアクセス ポリシーは、ポリシーで指定されたすべてのアプリケーションを "Defender for Cloud Apps アプリの条件付きアクセス制御" に転送します。 ユーザーが指定のアプリケーションに次回ログオンすると、対応するアプリケーションが自動的にアプリの条件付きアクセス制御に追加されます。 これらのアプリケーションは、Microsoft Defender ポータルで確認できます。 
 
>**ヒント:** このタスクを開始する前に、既存の条件付きアクセス制御アプリを確認する必要があります。 まだアプリケーションがオンボードされていないことがわかります。 この段階で、Defender for Cloud Apps でセッション ポリシーを作成してみて、発生するエラー メッセージを確認します。

このタスクでは、Microsoft Entra で条件付きアクセス ポリシーを作成して、アプリの条件付きアクセス制御をアプリケーションに展開します。 

1. 管理者アカウント **MOD 管理者**を使用して、Allan Deyoung として Microsoft Entra ポータル **https://entra.microsoft.com** にサインインします。
2. Microsoft Entra ポータルで、**[保護]** を展開し、**[条件付きアクセス]** を選びます。
3. **[条件付きアクセス | 概要]** ページで、**[ポリシー]** を選択し、**[+ 新しいポリシー]** を選択します。
4. ポリシーの名前を入力します。
5. **[割り当て]** で、**[ユーザー]** を選択し、**[すべてのユーザー]** を含めます。
6. **[割り当て]** で、**[ターゲット リソース]** を選択し、**[すべてのクラウド アプリ]** を含めます。
7. **[アクセス制御]** で、**[セッション]** を選択します。
8. **[セッション]** ペインで、**[アプリの条件付きアクセス制御を使用する]** を選択し、**[カスタム ポリシーの使用...]** を選択し、**[選択]** ボタンを使用して **[セッション]** ペインを閉じます。
9. **[ポリシーの有効化]** で、 **[オン]** を選択します。
10. 現在のユーザーをポリシーから除外する警告が表示された場合は、**[アカウントがこのポリシーの影響を受ける可能性があることを理解しています。続行します。]** を選択します。
11. 必要に応じて、条件と許可コントロールを指定します。
12. **［作成］** を選択します

次に、[Outlook](https://outlook.office365.com) など、いずれかの Microsoft Web アプリにサインインします。 サインインしたアプリケーションは、アプリの条件付きアクセス制御に自動的にオンボードされます。 Microsoft Defender ポータルにサインインし、アプリの条件付きアクセス制御にあるアプリケーションを表示します。

すべてのアプリケーションを Defender for Cloud Apps に転送し、オンボードされたアプリを条件付きアクセス アプリ制御に転送する条件付きアクセス ポリシーが正常に作成されました。

### タスク 3: Defender for Cloud Apps でセッション ポリシーを作成する

Defender for Cloud アプリで 2 つのセッション ポリシーを作成して、データのダウンロードをブロックし、アンマネージド デバイスのアクセス許可を制限します。

1. 管理者アカウント **MOD 管理者**を使用して、Allan Deyoung として Microsoft Defender ポータル **https://security.microsoft.com** にサインインします。
1. Microsoft Security ポータルの **[クラウド アプリ]** > **[ポリシー]** > **[ポリシー管理]** を選択します。
1. **[ポリシー]** ページで、**[+ ポリシーの作成]** > **[セッション ポリシー]** を選択します。
1. **[セッション ポリシーの作成]** ページで、ポリシー テンプレート **[リアルタイム コンテンツ検査に基づいてダウンロードをブロックする]** を選択します。
1. ポリシー名を入力します。
1. ポリシーの重大度とカテゴリを選択します。
1. 説明を入力します。
1. **[セッション制御のタイプ]** で、**[ファイルのダウンロードの制御 (検査あり)]** を選択します。
1. **[Activities matching all of the following]\(次のすべてに一致するアクティビティ)** セクションの **[アクティビティ ソース]** で、次のフィルターを選択します。

    - **デバイス タグ**: **[等しくない場合]** を選択し、**[Intune 準拠]** を選択します。

10. **[次のすべてに一致するファイル]** セクションで、次のフィルターを選択します。

    - **秘密度ラベル**: **[等しい]** を選択し、ラベル **"機密"**、**"非常に機密性の高い"** および **"機密 - 財務"** を選択します。

11. **[検査方法]** で、**[データ分類サービス]** を選択してから、**[任意]** を選択し、**[機密情報の種類...]** を選択し、このポリシーを適用する適切な機密情報の種類を選択します。
12. **[アクション]** で、**[ブロック]** を選択します。
13. **[作成]** を選択し、ポリシーを作成します。
14. 上記で説明したように 2 つ目のポリシーを作成し、ポリシー テンプレート **[リアルタイム コンテンツ検査に基づいてダウンロードをブロックする]** を選択します。
15. **[Activities matching all of the following]\(次のすべてに一致するアクティビティ)** の **[アクティビティ ソース]** で、次の情報を入力します。 

    - **アクティビティ タイプ**: **[等しい]** を選択し、**[アイテムの切り取り/コピー、アイテムの貼り付け]** を選択します。
    - **デバイス タグ**: **[等しくない]** を選択し、**[intune 準拠]** 選択します。

16. **[コンテンツ検査の使用]** を無効にし、**[作成]** を選択してポリシーを作成します。

Defender for Cloud Apps で 2 つのセッション ポリシーが正常に作成されました。
